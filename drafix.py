"""
    Fix DRA file generated by inFakt'
"""
import argparse

import zus


def parse_args() -> argparse.Namespace:
    """
    Parse script arguments

    :return: Parsed arguments
    """
    parser = argparse.ArgumentParser(description='Fix DRA file generated by inFakt')
    parser.add_argument('identity_document', help='ID card or passport number')
    parser.add_argument('kedu_file', help='ZUS KEDU file name')
    parser.add_argument('-n', '--no-backup', help='do not create backup file', action='store_true')
    parser.add_argument('-d', '--debug', help='print patched entries', action='store_true')
    return parser.parse_args()


def main() -> None:
    """
    Main function
    """
    args = parse_args()

    kedu_document = zus.kedu.KEDU()
    kedu_document.load(args.kedu_file)

    identity_document = zus.identity_document.IdentityDocument(args.identity_document)
    kedu_document.add_id_document(identity_document, args.debug)

    kedu_document.save(backup=not args.no_backup)
    print('Done')


if __name__ == '__main__':
    main()
